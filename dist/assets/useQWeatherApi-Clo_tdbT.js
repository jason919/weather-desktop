var $e=Object.defineProperty;var we=(o,s,n)=>s in o?$e(o,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[s]=n;var ie=(o,s,n)=>(we(o,typeof s!="symbol"?s+"":s,n),n);import{ae as ve,af as ge,k as ke,e as E,d as fe,z as _e,o as J,b as Me,a as U,C as de,f as re,t as Ce,W as De,ag as Se,Z as be,c as te,w as V,u as xe,O as ae,a4 as oe,r as T,i as ue}from"./index-DuPRxM8t.js";import{A as R,C as Le,K as We,L as Z,D as ce,J as Fe}from"./GeoApi-BM24uiIx.js";var pe={exports:{}};(function(o,s){(function(n,i){o.exports=i()})(ve,function(){var n=1e3,i=6e4,h=36e5,m="millisecond",_="second",y="minute",C="hour",D="day",L="week",g="month",A="quarter",S="year",x="date",N="Invalid Date",W=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,$=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,me={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(u){var r=["th","st","nd","rd"],e=u%100;return"["+u+(r[(e-20)%10]||r[e]||r[0])+"]"}},X=function(u,r,e){var a=String(u);return!a||a.length>=r?u:""+Array(r+1-a.length).join(e)+u},ye={s:X,z:function(u){var r=-u.utcOffset(),e=Math.abs(r),a=Math.floor(e/60),t=e%60;return(r<=0?"+":"-")+X(a,2,"0")+":"+X(t,2,"0")},m:function u(r,e){if(r.date()<e.date())return-u(e,r);var a=12*(e.year()-r.year())+(e.month()-r.month()),t=r.clone().add(a,g),c=e-t<0,l=r.clone().add(a+(c?-1:1),g);return+(-(a+(e-t)/(c?t-l:l-t))||0)},a:function(u){return u<0?Math.ceil(u)||0:Math.floor(u)},p:function(u){return{M:g,y:S,w:L,d:D,D:x,h:C,m:y,s:_,ms:m,Q:A}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(u){return u===void 0}},Y="en",O={};O[Y]=me;var ne="$isDayjsObject",ee=function(u){return u instanceof K||!(!u||!u[ne])},q=function u(r,e,a){var t;if(!r)return Y;if(typeof r=="string"){var c=r.toLowerCase();O[c]&&(t=c),e&&(O[c]=e,t=c);var l=r.split("-");if(!t&&l.length>1)return u(l[0])}else{var d=r.name;O[d]=r,t=d}return!a&&t&&(Y=t),t||!a&&Y},w=function(u,r){if(ee(u))return u.clone();var e=typeof r=="object"?r:{};return e.date=u,e.args=arguments,new K(e)},f=ye;f.l=q,f.i=ee,f.w=function(u,r){return w(u,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var K=function(){function u(e){this.$L=q(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[ne]=!0}var r=u.prototype;return r.parse=function(e){this.$d=function(a){var t=a.date,c=a.utc;if(t===null)return new Date(NaN);if(f.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var l=t.match(W);if(l){var d=l[2]-1||0,p=(l[7]||"0").substring(0,3);return c?new Date(Date.UTC(l[1],d,l[3]||1,l[4]||0,l[5]||0,l[6]||0,p)):new Date(l[1],d,l[3]||1,l[4]||0,l[5]||0,l[6]||0,p)}}return new Date(t)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return f},r.isValid=function(){return this.$d.toString()!==N},r.isSame=function(e,a){var t=w(e);return this.startOf(a)<=t&&t<=this.endOf(a)},r.isAfter=function(e,a){return w(e)<this.startOf(a)},r.isBefore=function(e,a){return this.endOf(a)<w(e)},r.$g=function(e,a,t){return f.u(e)?this[a]:this.set(t,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,a){var t=this,c=!!f.u(a)||a,l=f.p(e),d=function(I,M){var F=f.w(t.$u?Date.UTC(t.$y,M,I):new Date(t.$y,M,I),t);return c?F:F.endOf(D)},p=function(I,M){return f.w(t.toDate()[I].apply(t.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(M)),t)},v=this.$W,k=this.$M,b=this.$D,z="set"+(this.$u?"UTC":"");switch(l){case S:return c?d(1,0):d(31,11);case g:return c?d(1,k):d(0,k+1);case L:var j=this.$locale().weekStart||0,B=(v<j?v+7:v)-j;return d(c?b-B:b+(6-B),k);case D:case x:return p(z+"Hours",0);case C:return p(z+"Minutes",1);case y:return p(z+"Seconds",2);case _:return p(z+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,a){var t,c=f.p(e),l="set"+(this.$u?"UTC":""),d=(t={},t[D]=l+"Date",t[x]=l+"Date",t[g]=l+"Month",t[S]=l+"FullYear",t[C]=l+"Hours",t[y]=l+"Minutes",t[_]=l+"Seconds",t[m]=l+"Milliseconds",t)[c],p=c===D?this.$D+(a-this.$W):a;if(c===g||c===S){var v=this.clone().set(x,1);v.$d[d](p),v.init(),this.$d=v.set(x,Math.min(this.$D,v.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},r.set=function(e,a){return this.clone().$set(e,a)},r.get=function(e){return this[f.p(e)]()},r.add=function(e,a){var t,c=this;e=Number(e);var l=f.p(a),d=function(k){var b=w(c);return f.w(b.date(b.date()+Math.round(k*e)),c)};if(l===g)return this.set(g,this.$M+e);if(l===S)return this.set(S,this.$y+e);if(l===D)return d(1);if(l===L)return d(7);var p=(t={},t[y]=i,t[C]=h,t[_]=n,t)[l]||1,v=this.$d.getTime()+e*p;return f.w(v,this)},r.subtract=function(e,a){return this.add(-1*e,a)},r.format=function(e){var a=this,t=this.$locale();if(!this.isValid())return t.invalidDate||N;var c=e||"YYYY-MM-DDTHH:mm:ssZ",l=f.z(this),d=this.$H,p=this.$m,v=this.$M,k=t.weekdays,b=t.months,z=t.meridiem,j=function(M,F,H,Q){return M&&(M[F]||M(a,c))||H[F].slice(0,Q)},B=function(M){return f.s(d%12||12,M,"0")},I=z||function(M,F,H){var Q=M<12?"AM":"PM";return H?Q.toLowerCase():Q};return c.replace($,function(M,F){return F||function(H){switch(H){case"YY":return String(a.$y).slice(-2);case"YYYY":return f.s(a.$y,4,"0");case"M":return v+1;case"MM":return f.s(v+1,2,"0");case"MMM":return j(t.monthsShort,v,b,3);case"MMMM":return j(b,v);case"D":return a.$D;case"DD":return f.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return j(t.weekdaysMin,a.$W,k,2);case"ddd":return j(t.weekdaysShort,a.$W,k,3);case"dddd":return k[a.$W];case"H":return String(d);case"HH":return f.s(d,2,"0");case"h":return B(1);case"hh":return B(2);case"a":return I(d,p,!0);case"A":return I(d,p,!1);case"m":return String(p);case"mm":return f.s(p,2,"0");case"s":return String(a.$s);case"ss":return f.s(a.$s,2,"0");case"SSS":return f.s(a.$ms,3,"0");case"Z":return l}return null}(M)||l.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,a,t){var c,l=this,d=f.p(a),p=w(e),v=(p.utcOffset()-this.utcOffset())*i,k=this-p,b=function(){return f.m(l,p)};switch(d){case S:c=b()/12;break;case g:c=b();break;case A:c=b()/3;break;case L:c=(k-v)/6048e5;break;case D:c=(k-v)/864e5;break;case C:c=k/h;break;case y:c=k/i;break;case _:c=k/n;break;default:c=k}return t?c:f.a(c)},r.daysInMonth=function(){return this.endOf(g).$D},r.$locale=function(){return O[this.$L]},r.locale=function(e,a){if(!e)return this.$L;var t=this.clone(),c=q(e,a,!0);return c&&(t.$L=c),t},r.clone=function(){return f.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},u}(),se=K.prototype;return w.prototype=se,[["$ms",m],["$s",_],["$m",y],["$H",C],["$W",D],["$M",g],["$y",S],["$D",x]].forEach(function(u){se[u[1]]=function(r){return this.$g(r,u[0],u[1])}}),w.extend=function(u,r){return u.$i||(u(r,K,w),u.$i=!0),w},w.locale=q,w.isDayjs=ee,w.unix=function(u){return w(1e3*u)},w.en=O[Y],w.Ls=O,w.p={},w})})(pe);var Oe=pe.exports;const je=ge(Oe);var Ie={size:"1em",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",rtl:!1,theme:"outline",colors:{outline:{fill:"#333",background:"transparent"},filled:{fill:"#333",background:"#FFF"},twoTone:{fill:"#333",twoTone:"#2F88FF"},multiColor:{outStrokeColor:"#333",outFillColor:"#2F88FF",innerStrokeColor:"#FFF",innerFillColor:"#43CCF8"}},prefix:"i"};function Te(){return"icon-"+((1+Math.random())*4294967296|0).toString(16).substring(1)}function Ae(o,s,n){var i=typeof s.fill=="string"?[s.fill]:s.fill||[],h=[],m=s.theme||n.theme;switch(m){case"outline":h.push(typeof i[0]=="string"?i[0]:"currentColor"),h.push("none"),h.push(typeof i[0]=="string"?i[0]:"currentColor"),h.push("none");break;case"filled":h.push(typeof i[0]=="string"?i[0]:"currentColor"),h.push(typeof i[0]=="string"?i[0]:"currentColor"),h.push("#FFF"),h.push("#FFF");break;case"two-tone":h.push(typeof i[0]=="string"?i[0]:"currentColor"),h.push(typeof i[1]=="string"?i[1]:n.colors.twoTone.twoTone),h.push(typeof i[0]=="string"?i[0]:"currentColor"),h.push(typeof i[1]=="string"?i[1]:n.colors.twoTone.twoTone);break;case"multi-color":h.push(typeof i[0]=="string"?i[0]:"currentColor"),h.push(typeof i[1]=="string"?i[1]:n.colors.multiColor.outFillColor),h.push(typeof i[2]=="string"?i[2]:n.colors.multiColor.innerStrokeColor),h.push(typeof i[3]=="string"?i[3]:n.colors.multiColor.innerFillColor);break}return{size:s.size||n.size,strokeWidth:s.strokeWidth||n.strokeWidth,strokeLinecap:s.strokeLinecap||n.strokeLinecap,strokeLinejoin:s.strokeLinejoin||n.strokeLinejoin,colors:h,id:o}}var Ne=Symbol("icon-context");function ze(o,s,n){var i={name:"icon-"+o,props:["size","strokeWidth","strokeLinecap","strokeLinejoin","theme","fill","spin"],setup:function(m){var _=Te(),y=ke(Ne,Ie);return function(){var C=m.size,D=m.strokeWidth,L=m.strokeLinecap,g=m.strokeLinejoin,A=m.theme,S=m.fill,x=m.spin,N=Ae(_,{size:C,strokeWidth:D,strokeLinecap:L,strokeLinejoin:g,theme:A,fill:S},y),W=[y.prefix+"-icon"];return W.push(y.prefix+"-icon-"+o),s&&y.rtl&&W.push(y.prefix+"-icon-rtl"),x&&W.push(y.prefix+"-icon-spin"),E("span",{class:W.join(" ")},[n(N)])}}};return i}const Ge=ze("local-two",!1,function(o){return E("svg",{width:o.size,height:o.size,viewBox:"0 0 48 48",fill:"none"},[E("path",{d:"M24 44C24 44 39 32 39 19C39 10.7157 32.2843 4 24 4C15.7157 4 9 10.7157 9 19C9 32 24 44 24 44Z",fill:o.colors[1],stroke:o.colors[0],"stroke-width":o.strokeWidth,"stroke-linejoin":o.strokeLinejoin},null),E("path",{d:"M24 25C27.3137 25 30 22.3137 30 19C30 15.6863 27.3137 13 24 13C20.6863 13 18 15.6863 18 19C18 22.3137 20.6863 25 24 25Z",fill:o.colors[3],stroke:o.colors[2],"stroke-width":o.strokeWidth,"stroke-linejoin":o.strokeLinejoin},null)])}),Ee={class:"p-3"},Ye=fe({__name:"EmptyView",props:{msg:{type:String,required:!1}},setup(o){const s=_e(De,{});function n(){Se.openConfigPage(s.widgetParams.id)}return(i,h)=>(J(),Me("div",{class:"empty-key flex w-full text-center h-full items-center justify-center cursor-pointer",onClick:n},[U("p",Ee,[de(i.$slots,"default",{},()=>[re(Ce(o.msg),1)],!0)])]))}}),Be=(o,s)=>{const n=o.__vccOpts||o;for(const[i,h]of s)n[i]=h;return n},le=Be(Ye,[["__scopeId","data-v-46f7e593"]]),He={class:"flex flex-col gap-4 items-center"},Pe=U("span",null,"点击设置 和风天气 API KEY",-1),Ue={class:"flex flex-wrap gap-1 items-center justify-center"},qe=U("span",null,null,-1),Je=fe({__name:"QWeatherWrapper",props:{errorMsg:{type:String,required:!1},loading:{type:Boolean,required:!1},checkApiKey:{type:Boolean,required:!1,default:!0}},setup(o){const s=R("apiKey","");function n(){oe.openUrl("https://www.bilibili.com/video/BV1XQ4y1v7wS/?share_source=copy_web&vd_source=d97a783ed15a74f48591bd6098a158a4&t=39",{external:!0})}function i(){oe.openUrl("https://console.qweather.com/#/console",{external:!0})}return(h,m)=>{const _=Le,y=be("widget-wrapper");return J(),te(y,null,{default:V(()=>[o.checkApiKey&&!xe(s)?(J(),te(le,{key:0},{default:V(()=>[U("div",He,[Pe,U("div",Ue,[E(_,{onClick:ae(n,["stop"]),class:"w-20",type:"primary"},{default:V(()=>[re(" 视频教程 ")]),_:1}),qe,E(_,{onClick:ae(i,["stop"]),class:"w-20",type:"warning"},{default:V(()=>[re(" 申请地址 ")]),_:1})])])]),_:1})):o.errorMsg?(J(),te(le,{key:1,msg:o.errorMsg},null,8,["msg"])):de(h.$slots,"default",{key:2})]),_:3})}}});class Ke{static getBackgroundClass(s){return this.between(s,101,104)||this.between(s,151,153)?"city-weather-cloudy":this.between(s,101,399)?"city-weather-rain":this.between(s,400,499)?"city-weather-snow":this.between(s,500,515)?"city-weather-haze":"city-weather-sun"}static between(s,n,i){return s>=n&&s<=i}}const P=We.create({});P.interceptors.response.use(o=>{if(o.status==200){const s=o.data.code;let n="未知错误";return s!=200?(s==204?n="请求成功，但你查询的地区暂时没有你需要的数据。":s==400?n="请求错误，可能包含错误的请求参数或缺少必选的请求参数。":s==401?n="认证失败，可能使用了错误的KEY、数字签名错误、KEY的类型错误":s==402?n="超过访问次数或余额不足以支持继续访问服务":s==403?n="无访问权限，可能是绑定的PackageName、BundleID、域名IP地址不一致":s==404?n="查询的数据或地区不存在":s==429?n="超过限定的QPM（每分钟访问次数）":s==500&&(n="无响应或超时，接口服务异常请联系和风天气"),Promise.reject(new he(n,s))):Promise.resolve(o.data)}else return Promise.reject(new he("未知错误","未知错误"))},o=>Promise.reject(o));class he extends Error{constructor(n,i){super(n);ie(this,"code");this.code=i}}class G{static async weatherNow(s,n,i=Z){return await P.get(`https://devapi.qweather.com/v7/weather/now?location=${s}&key=${n}&lang=${i}`)}static async indices(s,n,i=1,h=Z){return await P.get(`https://devapi.qweather.com/v7/indices/${i}d?type=0&location=${s}&key=${n}&lang=${h}`)}static async weather3d(s,n,i=Z){return await P.get(`https://devapi.qweather.com/v7/weather/3d?location=${s}&key=${n}&lang=${i}`)}static async air5d(s,n,i=Z){return await P.get(`https://devapi.qweather.com/v7/air/5d?location=${s}&key=${n}&lang=${i}`)}}function Re(o){const s=R("locationId",ce.id),n=R("selectLocation",ce),i=R("apiKey",""),h=T(je()),m=T(""),_=T(),y=T(!1),C=T(),D=T(),L=T(),g=ue(()=>{var $;return($=_.value)==null?void 0:$.now}),A=ue(()=>{var $;return Ke.getBackgroundClass(Number.parseInt((($=g.value)==null?void 0:$.icon)??"100"))}),S=()=>{G.indices(n.value.id,i.value).then($=>{C.value=$.daily[Math.floor(Math.random()*$.daily.length)]})},x=()=>{G.weather3d(n.value.id,i.value).then($=>{L.value=$})},N=()=>{G.indices(n.value.id,i.value).then($=>{C.value=$.daily[Math.floor(Math.random()*$.daily.length)]})},W=()=>{m.value="",y.value=!0,o!=null&&o.useIndex&&S(),o!=null&&o.useAir&&N(),o!=null&&o.useWeather3d&&x(),G.weatherNow(n.value.id,i.value).then($=>{_.value=$}).catch($=>{m.value=$.message}).finally(()=>y.value=!1)};return Fe(()=>{W()},60*60*1e3),{locationId:s,selectLocation:n,apiKey:i,air5dResponse:D,backgroundClass:A,now:h,weatherData:g,dailyIndex:C,loading:y,weather3dResponse:L,update:W,errorMsg:m,responseData:_}}export{Ge as L,Je as _,Be as a,je as d,Re as u};
